(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{3100:function(ve,dt,pe){var ie=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,xe=Object.getOwnPropertyNames,Ce=Object.prototype.hasOwnProperty,Le=(j,B)=>{for(var J in B)ie(j,J,{get:B[J],enumerable:!0})},Re=(j,B,J,I)=>{if(B&&typeof B=="object"||typeof B=="function")for(let W of xe(B))!Ce.call(j,W)&&W!==J&&ie(j,W,{get:()=>B[W],enumerable:!(I=Ee(B,W))||I.enumerable});return j},Ie=j=>Re(ie({},"__esModule",{value:!0}),j),le={};Le(le,{ColladaLoader:()=>$}),ve.exports=Ie(le);var c=pe(933),me=pe(3104);class $ extends c.Loader{load(B,J,I,W){const M=this,te=M.path===""?c.LoaderUtils.extractUrlBase(B):M.path,P=new c.FileLoader(M.manager);P.setPath(M.path),P.setRequestHeader(M.requestHeader),P.setWithCredentials(M.withCredentials),P.load(B,function(de){try{J(M.parse(de,te))}catch(ne){W?W(ne):console.error(ne),M.manager.itemError(B)}},I,W)}parse(B,J){function I(t,e){const i=[],n=t.childNodes;for(let s=0,r=n.length;s<r;s++){const o=n[s];o.nodeName===e&&i.push(o)}return i}function W(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),i=new Array(e.length);for(let n=0,s=e.length;n<s;n++)i[n]=e[n];return i}function M(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),i=new Array(e.length);for(let n=0,s=e.length;n<s;n++)i[n]=parseFloat(e[n]);return i}function te(t){if(t.length===0)return[];const e=t.trim().split(/\s+/),i=new Array(e.length);for(let n=0,s=e.length;n<s;n++)i[n]=parseInt(e[n]);return i}function P(t){return t.substring(1)}function de(){return"three_default_"+hn++}function ne(t){return Object.keys(t).length===0}function Me(t){return{unit:be(I(t,"unit")[0]),upAxis:ge(I(t,"up_axis")[0])}}function be(t){return t!==void 0&&t.hasAttribute("meter")===!0?parseFloat(t.getAttribute("meter")):1}function ge(t){return t!==void 0?t.textContent:"Y_UP"}function z(t,e,i,n){const s=I(t,e)[0];if(s!==void 0){const r=I(s,i);for(let o=0;o<r.length;o++)n(r[o])}}function Y(t,e){for(const i in t){const n=t[i];n.build=e(t[i])}}function D(t,e){return t.build!==void 0||(t.build=e(t)),t.build}function ue(t){const e={sources:{},samplers:{},channels:{}};let i=!1;for(let n=0,s=t.childNodes.length;n<s;n++){const r=t.childNodes[n];if(r.nodeType!==1)continue;let o;switch(r.nodeName){case"source":o=r.getAttribute("id"),e.sources[o]=je(r);break;case"sampler":o=r.getAttribute("id"),e.samplers[o]=Oe(r);break;case"channel":o=r.getAttribute("target"),e.channels[o]=Se(r);break;case"animation":ue(r),i=!0;break;default:console.log(r)}}i===!1&&(w.animations[t.getAttribute("id")||c.MathUtils.generateUUID()]=e)}function Oe(t){const e={inputs:{}};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"input":const r=P(s.getAttribute("source")),o=s.getAttribute("semantic");e.inputs[o]=r;break}}return e}function Se(t){const e={};let n=t.getAttribute("target").split("/");const s=n.shift();let r=n.shift();const o=r.indexOf("(")!==-1,u=r.indexOf(".")!==-1;if(u)n=r.split("."),r=n.shift(),e.member=n.shift();else if(o){const l=r.split("(");r=l.shift();for(let d=0;d<l.length;d++)l[d]=parseInt(l[d].replace(/\)/,""));e.indices=l}return e.id=s,e.sid=r,e.arraySyntax=o,e.memberSyntax=u,e.sampler=P(t.getAttribute("source")),e}function ye(t){const e=[],i=t.channels,n=t.samplers,s=t.sources;for(const r in i)if(i.hasOwnProperty(r)){const o=i[r],u=n[o.sampler],l=u.inputs.INPUT,d=u.inputs.OUTPUT,b=s[l],a=s[d],m=Ge(o,b,a);se(m,e)}return e}function ke(t){return D(w.animations[t],ye)}function Ge(t,e,i){const n=w.nodes[t.id],s=ae(n.id),r=n.transforms[t.sid],o=n.matrix.clone().transpose();let u,l,d,b,a,m;const h={};switch(r){case"matrix":for(d=0,b=e.array.length;d<b;d++)if(u=e.array[d],l=d*i.stride,h[u]===void 0&&(h[u]={}),t.arraySyntax===!0){const U=i.array[l],x=t.indices[0]+4*t.indices[1];h[u][x]=U}else for(a=0,m=i.stride;a<m;a++)h[u][a]=i.array[l+a];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',r);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',r);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',r);break}const y=Pe(h,o);return{name:s.uuid,keyframes:y}}function Pe(t,e){const i=[];for(const s in t)i.push({time:parseFloat(s),value:t[s]});i.sort(n);for(let s=0;s<16;s++)fe(i,s,e.elements[s]);return i;function n(s,r){return s.time-r.time}}const O=new c.Vector3,q=new c.Vector3,S=new c.Quaternion;function se(t,e){const i=t.keyframes,n=t.name,s=[],r=[],o=[],u=[];for(let l=0,d=i.length;l<d;l++){const b=i[l],a=b.time,m=b.value;Z.fromArray(m).transpose(),Z.decompose(O,S,q),s.push(a),r.push(O.x,O.y,O.z),o.push(S.x,S.y,S.z,S.w),u.push(q.x,q.y,q.z)}return r.length>0&&e.push(new c.VectorKeyframeTrack(n+".position",s,r)),o.length>0&&e.push(new c.QuaternionKeyframeTrack(n+".quaternion",s,o)),u.length>0&&e.push(new c.VectorKeyframeTrack(n+".scale",s,u)),e}function fe(t,e,i){let n,s=!0,r,o;for(r=0,o=t.length;r<o;r++)n=t[r],n.value[e]===void 0?n.value[e]=null:s=!1;if(s===!0)for(r=0,o=t.length;r<o;r++)n=t[r],n.value[e]=i;else he(t,e)}function he(t,e){let i,n;for(let s=0,r=t.length;s<r;s++){const o=t[s];if(o.value[e]===null){if(i=we(t,s,e),n=Ne(t,s,e),i===null){o.value[e]=n.value[e];continue}if(n===null){o.value[e]=i.value[e];continue}p(o,i,n,e)}}}function we(t,e,i){for(;e>=0;){const n=t[e];if(n.value[i]!==null)return n;e--}return null}function Ne(t,e,i){for(;e<t.length;){const n=t[e];if(n.value[i]!==null)return n;e++}return null}function p(t,e,i,n){if(i.time-e.time===0){t.value[n]=e.value[n];return}t.value[n]=(t.time-e.time)*(i.value[n]-e.value[n])/(i.time-e.time)+e.value[n]}function H(t){const e={name:t.getAttribute("id")||"default",start:parseFloat(t.getAttribute("start")||0),end:parseFloat(t.getAttribute("end")||0),animations:[]};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"instance_animation":e.animations.push(P(s.getAttribute("url")));break}}w.clips[t.getAttribute("id")]=e}function L(t){const e=[],i=t.name,n=t.end-t.start||-1,s=t.animations;for(let r=0,o=s.length;r<o;r++){const u=ke(s[r]);for(let l=0,d=u.length;l<d;l++)e.push(u[l])}return new c.AnimationClip(i,n,e)}function C(t){return D(w.clips[t],L)}function F(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"skin":e.id=P(s.getAttribute("source")),e.skin=E(s);break;case"morph":e.id=P(s.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}w.controllers[t.getAttribute("id")]=e}function E(t){const e={sources:{}};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"bind_shape_matrix":e.bindShapeMatrix=M(s.textContent);break;case"source":const r=s.getAttribute("id");e.sources[r]=je(s);break;case"joints":e.joints=R(s);break;case"vertex_weights":e.vertexWeights=T(s);break}}return e}function R(t){const e={inputs:{}};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"input":const r=s.getAttribute("semantic"),o=P(s.getAttribute("source"));e.inputs[r]=o;break}}return e}function T(t){const e={inputs:{}};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"input":const r=s.getAttribute("semantic"),o=P(s.getAttribute("source")),u=parseInt(s.getAttribute("offset"));e.inputs[r]={id:o,offset:u};break;case"vcount":e.vcount=te(s.textContent);break;case"v":e.v=te(s.textContent);break}}return e}function A(t){const e={id:t.id},i=w.geometries[e.id];return t.skin!==void 0&&(e.skin=k(t.skin),i.sources.skinIndices=e.skin.indices,i.sources.skinWeights=e.skin.weights),e}function k(t){const i={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},n=t.sources,s=t.vertexWeights,r=s.vcount,o=s.v,u=s.inputs.JOINT.offset,l=s.inputs.WEIGHT.offset,d=t.sources[t.joints.inputs.JOINT],b=t.sources[t.joints.inputs.INV_BIND_MATRIX],a=n[s.inputs.WEIGHT.id].array;let m=0,h,y,g;for(h=0,g=r.length;h<g;h++){const x=r[h],_=[];for(y=0;y<x;y++){const v=o[m+u],ee=o[m+l],K=a[ee];_.push({index:v,weight:K}),m+=2}for(_.sort(U),y=0;y<4;y++){const v=_[y];v!==void 0?(i.indices.array.push(v.index),i.weights.array.push(v.weight)):(i.indices.array.push(0),i.weights.array.push(0))}}for(t.bindShapeMatrix?i.bindMatrix=new c.Matrix4().fromArray(t.bindShapeMatrix).transpose():i.bindMatrix=new c.Matrix4().identity(),h=0,g=d.array.length;h<g;h++){const x=d.array[h],_=new c.Matrix4().fromArray(b.array,h*b.stride).transpose();i.joints.push({name:x,boneInverse:_})}return i;function U(x,_){return _.weight-x.weight}}function f(t){return D(w.controllers[t],A)}function N(t){const e={init_from:I(t,"init_from")[0].textContent};w.images[t.getAttribute("id")]=e}function G(t){return t.build!==void 0?t.build:t.init_from}function X(t){const e=w.images[t];return e!==void 0?D(e,G):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",t),null)}function re(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"profile_COMMON":e.profile=ut(s);break}}w.effects[t.getAttribute("id")]=e}function ut(t){const e={surfaces:{},samplers:{}};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"newparam":ft(s,e);break;case"technique":e.technique=mt(s);break;case"extra":e.extra=Ve(s);break}}return e}function ft(t,e){const i=t.getAttribute("sid");for(let n=0,s=t.childNodes.length;n<s;n++){const r=t.childNodes[n];if(r.nodeType===1)switch(r.nodeName){case"surface":e.surfaces[i]=ht(r);break;case"sampler2D":e.samplers[i]=pt(r);break}}}function ht(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"init_from":e.init_from=s.textContent;break}}return e}function pt(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"source":e.source=s.textContent;break}}return e}function mt(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"constant":case"lambert":case"blinn":case"phong":e.type=s.nodeName,e.parameters=bt(s);break;case"extra":e.extra=Ve(s);break}}return e}function bt(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":e[s.nodeName]=He(s);break;case"transparent":e[s.nodeName]={opaque:s.hasAttribute("opaque")?s.getAttribute("opaque"):"A_ONE",data:He(s)};break}}return e}function He(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"color":e[s.nodeName]=M(s.textContent);break;case"float":e[s.nodeName]=parseFloat(s.textContent);break;case"texture":e[s.nodeName]={id:s.getAttribute("texture"),extra:Fe(s)};break}}return e}function Fe(t){const e={technique:{}};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"extra":gt(s,e);break}}return e}function gt(t,e){for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"technique":yt(s,e);break}}}function yt(t,e){for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":e.technique[s.nodeName]=parseFloat(s.textContent);break;case"wrapU":case"wrapV":s.textContent.toUpperCase()==="TRUE"?e.technique[s.nodeName]=1:s.textContent.toUpperCase()==="FALSE"?e.technique[s.nodeName]=0:e.technique[s.nodeName]=parseInt(s.textContent);break;case"bump":e[s.nodeName]=ze(s);break}}}function Ve(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"technique":e.technique=kt(s);break}}return e}function kt(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"double_sided":e[s.nodeName]=parseInt(s.textContent);break;case"bump":e[s.nodeName]=ze(s);break}}return e}function ze(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"texture":e[s.nodeName]={id:s.getAttribute("texture"),texcoord:s.getAttribute("texcoord"),extra:Fe(s)};break}}return e}function De(t){return t}function wt(t){return D(w.effects[t],De)}function Nt(t){const e={name:t.getAttribute("name")};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"instance_effect":e.url=P(s.getAttribute("url"));break}}w.materials[t.getAttribute("id")]=e}function At(t){let e,i=t.slice((t.lastIndexOf(".")-1>>>0)+2);switch(i=i.toLowerCase(),i){case"tga":e=Ue;break;default:e=at}return e}function Je(t){const e=wt(t.url),i=e.profile.technique;let n;switch(i.type){case"phong":case"blinn":n=new c.MeshPhongMaterial;break;case"lambert":n=new c.MeshLambertMaterial;break;default:n=new c.MeshBasicMaterial;break}n.name=t.name||"";function s(l,d=null){const b=e.profile.samplers[l.id];let a=null;if(b!==void 0){const m=e.profile.surfaces[b.source];a=X(m.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),a=X(l.id);if(a!==null){const m=At(a);if(m!==void 0){const h=m.load(a),y=l.extra;if(y!==void 0&&y.technique!==void 0&&ne(y.technique)===!1){const g=y.technique;h.wrapS=g.wrapU?c.RepeatWrapping:c.ClampToEdgeWrapping,h.wrapT=g.wrapV?c.RepeatWrapping:c.ClampToEdgeWrapping,h.offset.set(g.offsetU||0,g.offsetV||0),h.repeat.set(g.repeatU||1,g.repeatV||1)}else h.wrapS=c.RepeatWrapping,h.wrapT=c.RepeatWrapping;return d!==null&&(h.colorSpace=d),h}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",a),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",l.id),null}const r=i.parameters;for(const l in r){const d=r[l];switch(l){case"diffuse":d.color&&n.color.fromArray(d.color),d.texture&&(n.map=s(d.texture,c.SRGBColorSpace));break;case"specular":d.color&&n.specular&&n.specular.fromArray(d.color),d.texture&&(n.specularMap=s(d.texture));break;case"bump":d.texture&&(n.normalMap=s(d.texture));break;case"ambient":d.texture&&(n.lightMap=s(d.texture,c.SRGBColorSpace));break;case"shininess":d.float&&n.shininess&&(n.shininess=d.float);break;case"emission":d.color&&n.emissive&&n.emissive.fromArray(d.color),d.texture&&(n.emissiveMap=s(d.texture,c.SRGBColorSpace));break}}n.color.convertSRGBToLinear(),n.specular&&n.specular.convertSRGBToLinear(),n.emissive&&n.emissive.convertSRGBToLinear();let o=r.transparent,u=r.transparency;if(u===void 0&&o&&(u={float:1}),o===void 0&&u&&(o={opaque:"A_ONE",data:{color:[1,1,1,1]}}),o&&u)if(o.data.texture)n.transparent=!0;else{const l=o.data.color;switch(o.opaque){case"A_ONE":n.opacity=l[3]*u.float;break;case"RGB_ZERO":n.opacity=1-l[0]*u.float;break;case"A_ZERO":n.opacity=1-l[3]*u.float;break;case"RGB_ONE":n.opacity=l[0]*u.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',o.opaque)}n.opacity<1&&(n.transparent=!0)}if(i.extra!==void 0&&i.extra.technique!==void 0){const l=i.extra.technique;for(const d in l){const b=l[d];switch(d){case"double_sided":n.side=b===1?c.DoubleSide:c.FrontSide;break;case"bump":n.normalMap=s(b.texture),n.normalScale=new c.Vector2(1,1);break}}}return n}function Tt(t){return D(w.materials[t],Je)}function _t(t){const e={name:t.getAttribute("name")};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"optics":e.optics=vt(s);break}}w.cameras[t.getAttribute("id")]=e}function vt(t){for(let e=0;e<t.childNodes.length;e++){const i=t.childNodes[e];switch(i.nodeName){case"technique_common":return Et(i)}}return{}}function Et(t){const e={};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];switch(n.nodeName){case"perspective":case"orthographic":e.technique=n.nodeName,e.parameters=xt(n);break}}return e}function xt(t){const e={};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];switch(n.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":e[n.nodeName]=parseFloat(n.textContent);break}}return e}function Ke(t){let e;switch(t.optics.technique){case"perspective":e=new c.PerspectiveCamera(t.optics.parameters.yfov,t.optics.parameters.aspect_ratio,t.optics.parameters.znear,t.optics.parameters.zfar);break;case"orthographic":let i=t.optics.parameters.ymag,n=t.optics.parameters.xmag;const s=t.optics.parameters.aspect_ratio;n=n===void 0?i*s:n,i=i===void 0?n/s:i,n*=.5,i*=.5,e=new c.OrthographicCamera(-n,n,i,-i,t.optics.parameters.znear,t.optics.parameters.zfar);break;default:e=new c.PerspectiveCamera;break}return e.name=t.name||"",e}function Ct(t){const e=w.cameras[t];return e!==void 0?D(e,Ke):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",t),null)}function Lt(t){let e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"technique_common":e=Rt(s);break}}w.lights[t.getAttribute("id")]=e}function Rt(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"directional":case"point":case"spot":case"ambient":e.technique=s.nodeName,e.parameters=It(s)}}return e}function It(t){const e={};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"color":const r=M(s.textContent);e.color=new c.Color().fromArray(r).convertSRGBToLinear();break;case"falloff_angle":e.falloffAngle=parseFloat(s.textContent);break;case"quadratic_attenuation":const o=parseFloat(s.textContent);e.distance=o?Math.sqrt(1/o):0;break}}return e}function We(t){let e;switch(t.technique){case"directional":e=new c.DirectionalLight;break;case"point":e=new c.PointLight;break;case"spot":e=new c.SpotLight;break;case"ambient":e=new c.AmbientLight;break}return t.parameters.color&&e.color.copy(t.parameters.color),t.parameters.distance&&(e.distance=t.parameters.distance),e}function Mt(t){const e=w.lights[t];return e!==void 0?D(e,We):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",t),null)}function Ot(t){const e={name:t.getAttribute("name"),sources:{},vertices:{},primitives:[]},i=I(t,"mesh")[0];if(i!==void 0){for(let n=0;n<i.childNodes.length;n++){const s=i.childNodes[n];if(s.nodeType!==1)continue;const r=s.getAttribute("id");switch(s.nodeName){case"source":e.sources[r]=je(s);break;case"vertices":e.vertices=St(s);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",s.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":e.primitives.push(Gt(s));break;default:console.log(s)}}w.geometries[t.getAttribute("id")]=e}}function je(t){const e={array:[],stride:3};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"float_array":e.array=M(n.textContent);break;case"Name_array":e.array=W(n.textContent);break;case"technique_common":const s=I(n,"accessor")[0];s!==void 0&&(e.stride=parseInt(s.getAttribute("stride")));break}}return e}function St(t){const e={};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];n.nodeType===1&&(e[n.getAttribute("semantic")]=P(n.getAttribute("source")))}return e}function Gt(t){const e={type:t.nodeName,material:t.getAttribute("material"),count:parseInt(t.getAttribute("count")),inputs:{},stride:0,hasUV:!1};for(let i=0,n=t.childNodes.length;i<n;i++){const s=t.childNodes[i];if(s.nodeType===1)switch(s.nodeName){case"input":const r=P(s.getAttribute("source")),o=s.getAttribute("semantic"),u=parseInt(s.getAttribute("offset")),l=parseInt(s.getAttribute("set")),d=l>0?o+l:o;e.inputs[d]={id:r,offset:u},e.stride=Math.max(e.stride,u+1),o==="TEXCOORD"&&(e.hasUV=!0);break;case"vcount":e.vcount=te(s.textContent);break;case"p":e.p=te(s.textContent);break}}return e}function Pt(t){const e={};for(let i=0;i<t.length;i++){const n=t[i];e[n.type]===void 0&&(e[n.type]=[]),e[n.type].push(n)}return e}function jt(t){let e=0;for(let i=0,n=t.length;i<n;i++)t[i].hasUV===!0&&e++;e>0&&e<t.length&&(t.uvsNeedsFix=!0)}function Ye(t){const e={},i=t.sources,n=t.vertices,s=t.primitives;if(s.length===0)return{};const r=Pt(s);for(const o in r){const u=r[o];jt(u),e[o]=qt(u,i,n)}return e}function qt(t,e,i){const n={},s={array:[],stride:0},r={array:[],stride:0},o={array:[],stride:0},u={array:[],stride:0},l={array:[],stride:0},d={array:[],stride:4},b={array:[],stride:4},a=new c.BufferGeometry,m=[];let h=0;for(let y=0;y<t.length;y++){const g=t[y],U=g.inputs;let x=0;switch(g.type){case"lines":case"linestrips":x=g.count*2;break;case"triangles":x=g.count*3;break;case"polylist":for(let _=0;_<g.count;_++){const v=g.vcount[_];switch(v){case 3:x+=3;break;case 4:x+=6;break;default:x+=(v-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",g.type)}a.addGroup(h,x,y),h+=x,g.material&&m.push(g.material);for(const _ in U){const v=U[_];switch(_){case"VERTEX":for(const ee in i){const K=i[ee];switch(ee){case"POSITION":const ce=s.array.length;if(Q(g,e[K],v.offset,s.array),s.stride=e[K].stride,e.skinWeights&&e.skinIndices&&(Q(g,e.skinIndices,v.offset,d.array),Q(g,e.skinWeights,v.offset,b.array)),g.hasUV===!1&&t.uvsNeedsFix===!0){const pn=(s.array.length-ce)/s.stride;for(let lt=0;lt<pn;lt++)o.array.push(0,0)}break;case"NORMAL":Q(g,e[K],v.offset,r.array),r.stride=e[K].stride;break;case"COLOR":Q(g,e[K],v.offset,l.array),l.stride=e[K].stride;break;case"TEXCOORD":Q(g,e[K],v.offset,o.array),o.stride=e[K].stride;break;case"TEXCOORD1":Q(g,e[K],v.offset,u.array),o.stride=e[K].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',ee)}}break;case"NORMAL":Q(g,e[v.id],v.offset,r.array),r.stride=e[v.id].stride;break;case"COLOR":Q(g,e[v.id],v.offset,l.array,!0),l.stride=e[v.id].stride;break;case"TEXCOORD":Q(g,e[v.id],v.offset,o.array),o.stride=e[v.id].stride;break;case"TEXCOORD1":Q(g,e[v.id],v.offset,u.array),u.stride=e[v.id].stride;break}}}return s.array.length>0&&a.setAttribute("position",new c.Float32BufferAttribute(s.array,s.stride)),r.array.length>0&&a.setAttribute("normal",new c.Float32BufferAttribute(r.array,r.stride)),l.array.length>0&&a.setAttribute("color",new c.Float32BufferAttribute(l.array,l.stride)),o.array.length>0&&a.setAttribute("uv",new c.Float32BufferAttribute(o.array,o.stride)),u.array.length>0&&a.setAttribute("uv1",new c.Float32BufferAttribute(u.array,u.stride)),d.array.length>0&&a.setAttribute("skinIndex",new c.Float32BufferAttribute(d.array,d.stride)),b.array.length>0&&a.setAttribute("skinWeight",new c.Float32BufferAttribute(b.array,b.stride)),n.data=a,n.type=t[0].type,n.materialKeys=m,n}function Q(t,e,i,n,s=!1){const r=t.p,o=t.stride,u=t.vcount;function l(a){let m=r[a+i]*b;const h=m+b;for(;m<h;m++)n.push(d[m]);if(s){const y=n.length-b-1;Ae.setRGB(n[y+0],n[y+1],n[y+2]).convertSRGBToLinear(),n[y+0]=Ae.r,n[y+1]=Ae.g,n[y+2]=Ae.b}}const d=e.array,b=e.stride;if(t.vcount!==void 0){let a=0;for(let m=0,h=u.length;m<h;m++){const y=u[m];if(y===4){const g=a+o*0,U=a+o*1,x=a+o*2,_=a+o*3;l(g),l(U),l(_),l(U),l(x),l(_)}else if(y===3){const g=a+o*0,U=a+o*1,x=a+o*2;l(g),l(U),l(x)}else if(y>4)for(let g=1,U=y-2;g<=U;g++){const x=a+o*0,_=a+o*g,v=a+o*(g+1);l(x),l(_),l(v)}a+=o*y}}else for(let a=0,m=r.length;a<m;a+=o)l(a)}function Xe(t){return D(w.geometries[t],Ye)}function Bt(t){const e={name:t.getAttribute("name")||"",joints:{},links:[]};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"technique_common":Ft(n,e);break}}w.kinematicsModels[t.getAttribute("id")]=e}function Ut(t){return t.build!==void 0?t.build:t}function Ht(t){return D(w.kinematicsModels[t],Ut)}function Ft(t,e){for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"joint":e.joints[n.getAttribute("sid")]=Vt(n);break;case"link":e.links.push(Ze(n));break}}}function Vt(t){let e;for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"prismatic":case"revolute":e=zt(n);break}}return e}function zt(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",axis:new c.Vector3,limits:{min:0,max:0},type:t.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"axis":const s=M(n.textContent);e.axis.fromArray(s);break;case"limits":const r=n.getElementsByTagName("max")[0],o=n.getElementsByTagName("min")[0];e.limits.max=parseFloat(r.textContent),e.limits.min=parseFloat(o.textContent);break}}return e.limits.min>=e.limits.max&&(e.static=!0),e.middlePosition=(e.limits.min+e.limits.max)/2,e}function Ze(t){const e={sid:t.getAttribute("sid"),name:t.getAttribute("name")||"",attachments:[],transforms:[]};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"attachment_full":e.attachments.push(Dt(n));break;case"matrix":case"translate":case"rotate":e.transforms.push(Qe(n));break}}return e}function Dt(t){const e={joint:t.getAttribute("joint").split("/").pop(),transforms:[],links:[]};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"link":e.links.push(Ze(n));break;case"matrix":case"translate":case"rotate":e.transforms.push(Qe(n));break}}return e}function Qe(t){const e={type:t.nodeName},i=M(t.textContent);switch(e.type){case"matrix":e.obj=new c.Matrix4,e.obj.fromArray(i).transpose();break;case"translate":e.obj=new c.Vector3,e.obj.fromArray(i);break;case"rotate":e.obj=new c.Vector3,e.obj.fromArray(i),e.angle=c.MathUtils.degToRad(i[3]);break}return e}function Jt(t){const e={name:t.getAttribute("name")||"",rigidBodies:{}};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"rigid_body":e.rigidBodies[n.getAttribute("name")]={},Kt(n,e.rigidBodies[n.getAttribute("name")]);break}}w.physicsModels[t.getAttribute("id")]=e}function Kt(t,e){for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"technique_common":Wt(n,e);break}}}function Wt(t,e){for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"inertia":e.inertia=M(n.textContent);break;case"mass":e.mass=M(n.textContent)[0];break}}}function Yt(t){const e={bindJointAxis:[]};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"bind_joint_axis":e.bindJointAxis.push(Xt(n));break}}w.kinematicsScenes[P(t.getAttribute("url"))]=e}function Xt(t){const e={target:t.getAttribute("target").split("/").pop()};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType===1)switch(n.nodeName){case"axis":const s=n.getElementsByTagName("param")[0];e.axis=s.textContent;const r=e.axis.split("inst_").pop().split("axis")[0];e.jointIndex=r.substring(0,r.length-1);break}}return e}function Zt(t){return t.build!==void 0?t.build:t}function Qt(t){return D(w.kinematicsScenes[t],Zt)}function $t(){const t=Object.keys(w.kinematicsModels)[0],e=Object.keys(w.kinematicsScenes)[0],i=Object.keys(w.visualScenes)[0];if(t===void 0||e===void 0)return;const n=Ht(t),s=Qt(e),r=st(i),o=s.bindJointAxis,u={};for(let b=0,a=o.length;b<a;b++){const m=o[b],h=V.querySelector('[sid="'+m.target+'"]');if(h){const y=h.parentElement;l(m.jointIndex,y)}}function l(b,a){const m=a.getAttribute("name"),h=n.joints[b];r.traverse(function(y){y.name===m&&(u[b]={object:y,transforms:en(a),joint:h,position:h.zeroPosition})})}const d=new c.Matrix4;ct={joints:n&&n.joints,getJointValue:function(b){const a=u[b];if(a)return a.position;console.warn("THREE.ColladaLoader: Joint "+b+" doesn't exist.")},setJointValue:function(b,a){const m=u[b];if(m){const h=m.joint;if(a>h.limits.max||a<h.limits.min)console.warn("THREE.ColladaLoader: Joint "+b+" value "+a+" outside of limits (min: "+h.limits.min+", max: "+h.limits.max+").");else if(h.static)console.warn("THREE.ColladaLoader: Joint "+b+" is static.");else{const y=m.object,g=h.axis,U=m.transforms;Z.identity();for(let x=0;x<U.length;x++){const _=U[x];if(_.sid&&_.sid.indexOf(b)!==-1)switch(h.type){case"revolute":Z.multiply(d.makeRotationAxis(g,c.MathUtils.degToRad(a)));break;case"prismatic":Z.multiply(d.makeTranslation(g.x*a,g.y*a,g.z*a));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+h.type);break}else switch(_.type){case"matrix":Z.multiply(_.obj);break;case"translate":Z.multiply(d.makeTranslation(_.obj.x,_.obj.y,_.obj.z));break;case"scale":Z.scale(_.obj);break;case"rotate":Z.multiply(d.makeRotationAxis(_.obj,_.angle));break}}y.matrix.copy(Z),y.matrix.decompose(y.position,y.quaternion,y.scale),u[b].position=a}}else console.log("THREE.ColladaLoader: "+b+" does not exist.")}}}function en(t){const e=[],i=V.querySelector('[id="'+t.id+'"]');for(let n=0;n<i.childNodes.length;n++){const s=i.childNodes[n];if(s.nodeType!==1)continue;let r,o;switch(s.nodeName){case"matrix":r=M(s.textContent);const u=new c.Matrix4().fromArray(r).transpose();e.push({sid:s.getAttribute("sid"),type:s.nodeName,obj:u});break;case"translate":case"scale":r=M(s.textContent),o=new c.Vector3().fromArray(r),e.push({sid:s.getAttribute("sid"),type:s.nodeName,obj:o});break;case"rotate":r=M(s.textContent),o=new c.Vector3().fromArray(r);const l=c.MathUtils.degToRad(r[3]);e.push({sid:s.getAttribute("sid"),type:s.nodeName,obj:o,angle:l});break}}return e}function tn(t){const e=t.getElementsByTagName("node");for(let i=0;i<e.length;i++){const n=e[i];n.hasAttribute("id")===!1&&n.setAttribute("id",de())}}const Z=new c.Matrix4,oe=new c.Vector3;function qe(t){const e={name:t.getAttribute("name")||"",type:t.getAttribute("type"),id:t.getAttribute("id"),sid:t.getAttribute("sid"),matrix:new c.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];if(n.nodeType!==1)continue;let s;switch(n.nodeName){case"node":e.nodes.push(n.getAttribute("id")),qe(n);break;case"instance_camera":e.instanceCameras.push(P(n.getAttribute("url")));break;case"instance_controller":e.instanceControllers.push($e(n));break;case"instance_light":e.instanceLights.push(P(n.getAttribute("url")));break;case"instance_geometry":e.instanceGeometries.push($e(n));break;case"instance_node":e.instanceNodes.push(P(n.getAttribute("url")));break;case"matrix":s=M(n.textContent),e.matrix.multiply(Z.fromArray(s).transpose()),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"translate":s=M(n.textContent),oe.fromArray(s),e.matrix.multiply(Z.makeTranslation(oe.x,oe.y,oe.z)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"rotate":s=M(n.textContent);const r=c.MathUtils.degToRad(s[3]);e.matrix.multiply(Z.makeRotationAxis(oe.fromArray(s),r)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"scale":s=M(n.textContent),e.matrix.scale(oe.fromArray(s)),e.transforms[n.getAttribute("sid")]=n.nodeName;break;case"extra":break;default:console.log(n)}}return nt(e.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",e.id):w.nodes[e.id]=e,e}function $e(t){const e={id:P(t.getAttribute("url")),materials:{},skeletons:[]};for(let i=0;i<t.childNodes.length;i++){const n=t.childNodes[i];switch(n.nodeName){case"bind_material":const s=n.getElementsByTagName("instance_material");for(let r=0;r<s.length;r++){const o=s[r],u=o.getAttribute("symbol"),l=o.getAttribute("target");e.materials[u]=P(l)}break;case"skeleton":e.skeletons.push(P(n.textContent));break;default:break}}return e}function nn(t,e){const i=[],n=[];let s,r,o;for(s=0;s<t.length;s++){const d=t[s];let b;if(nt(d))b=ae(d),et(b,e,i);else if(cn(d)){const m=w.visualScenes[d].children;for(let h=0;h<m.length;h++){const y=m[h];if(y.type==="JOINT"){const g=ae(y.id);et(g,e,i)}}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",d)}for(s=0;s<e.length;s++)for(r=0;r<i.length;r++)if(o=i[r],o.bone.name===e[s].name){n[s]=o,o.processed=!0;break}for(s=0;s<i.length;s++)o=i[s],o.processed===!1&&(n.push(o),o.processed=!0);const u=[],l=[];for(s=0;s<n.length;s++)o=n[s],u.push(o.bone),l.push(o.boneInverse);return new c.Skeleton(u,l)}function et(t,e,i){t.traverse(function(n){if(n.isBone===!0){let s;for(let r=0;r<e.length;r++){const o=e[r];if(o.name===n.name){s=o.boneInverse;break}}s===void 0&&(s=new c.Matrix4),i.push({bone:n,boneInverse:s,processed:!1})}})}function sn(t){const e=[],i=t.matrix,n=t.nodes,s=t.type,r=t.instanceCameras,o=t.instanceControllers,u=t.instanceLights,l=t.instanceGeometries,d=t.instanceNodes;for(let a=0,m=n.length;a<m;a++)e.push(ae(n[a]));for(let a=0,m=r.length;a<m;a++){const h=Ct(r[a]);h!==null&&e.push(h.clone())}for(let a=0,m=o.length;a<m;a++){const h=o[a],y=f(h.id),g=Xe(y.id),U=tt(g,h.materials),x=h.skeletons,_=y.skin.joints,v=nn(x,_);for(let ee=0,K=U.length;ee<K;ee++){const ce=U[ee];ce.isSkinnedMesh&&(ce.bind(v,y.skin.bindMatrix),ce.normalizeSkinWeights()),e.push(ce)}}for(let a=0,m=u.length;a<m;a++){const h=Mt(u[a]);h!==null&&e.push(h.clone())}for(let a=0,m=l.length;a<m;a++){const h=l[a],y=Xe(h.id),g=tt(y,h.materials);for(let U=0,x=g.length;U<x;U++)e.push(g[U])}for(let a=0,m=d.length;a<m;a++)e.push(ae(d[a]).clone());let b;if(n.length===0&&e.length===1)b=e[0];else{b=s==="JOINT"?new c.Bone:new c.Group;for(let a=0;a<e.length;a++)b.add(e[a])}return b.name=s==="JOINT"?t.sid:t.name,b.matrix.copy(i),b.matrix.decompose(b.position,b.quaternion,b.scale),b}const rn=new c.MeshBasicMaterial({name:c.Loader.DEFAULT_MATERIAL_NAME,color:16711935});function on(t,e){const i=[];for(let n=0,s=t.length;n<s;n++){const r=e[t[n]];r===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",t[n]),i.push(rn)):i.push(Tt(r))}return i}function tt(t,e){const i=[];for(const n in t){const s=t[n],r=on(s.materialKeys,e);if(r.length===0&&(n==="lines"||n==="linestrips"?r.push(new c.LineBasicMaterial):r.push(new c.MeshPhongMaterial)),n==="lines"||n==="linestrips")for(let d=0,b=r.length;d<b;d++){const a=r[d];if(a.isMeshPhongMaterial===!0||a.isMeshLambertMaterial===!0){const m=new c.LineBasicMaterial;m.color.copy(a.color),m.opacity=a.opacity,m.transparent=a.transparent,r[d]=m}}const o=s.data.attributes.skinIndex!==void 0,u=r.length===1?r[0]:r;let l;switch(n){case"lines":l=new c.LineSegments(s.data,u);break;case"linestrips":l=new c.Line(s.data,u);break;case"triangles":case"polylist":o?l=new c.SkinnedMesh(s.data,u):l=new c.Mesh(s.data,u);break}i.push(l)}return i}function nt(t){return w.nodes[t]!==void 0}function ae(t){return D(w.nodes[t],sn)}function an(t){const e={name:t.getAttribute("name"),children:[]};tn(t);const i=I(t,"node");for(let n=0;n<i.length;n++)e.children.push(qe(i[n]));w.visualScenes[t.getAttribute("id")]=e}function it(t){const e=new c.Group;e.name=t.name;const i=t.children;for(let n=0;n<i.length;n++){const s=i[n];e.add(ae(s.id))}return e}function cn(t){return w.visualScenes[t]!==void 0}function st(t){return D(w.visualScenes[t],it)}function ln(t){const e=I(t,"instance_visual_scene")[0];return st(P(e.getAttribute("url")))}function dn(){const t=w.clips;if(ne(t)===!0){if(ne(w.animations)===!1){const e=[];for(const i in w.animations){const n=ke(i);for(let s=0,r=n.length;s<r;s++)e.push(n[s])}Te.push(new c.AnimationClip("default",-1,e))}}else for(const e in t)Te.push(C(e))}function un(t){let e="";const i=[t];for(;i.length;){const n=i.shift();n.nodeType===Node.TEXT_NODE?e+=n.textContent:(e+=`
`,i.push.apply(i,n.childNodes))}return e.trim()}if(B.length===0)return{scene:new c.Scene};const rt=new DOMParser().parseFromString(B,"application/xml"),V=I(rt,"COLLADA")[0],Be=rt.getElementsByTagName("parsererror")[0];if(Be!==void 0){const t=I(Be,"div")[0];let e;return t?e=t.textContent:e=un(Be),console.error(`THREE.ColladaLoader: Failed to parse collada file.
`,e),null}const fn=V.getAttribute("version");console.debug("THREE.ColladaLoader: File version",fn);const ot=Me(I(V,"asset")[0]),at=new c.TextureLoader(this.manager);at.setPath(this.resourcePath||J).setCrossOrigin(this.crossOrigin);let Ue;me.TGALoader&&(Ue=new me.TGALoader(this.manager),Ue.setPath(this.resourcePath||J));const Ae=new c.Color,Te=[];let ct={},hn=0;const w={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};z(V,"library_animations","animation",ue),z(V,"library_animation_clips","animation_clip",H),z(V,"library_controllers","controller",F),z(V,"library_images","image",N),z(V,"library_effects","effect",re),z(V,"library_materials","material",Nt),z(V,"library_cameras","camera",_t),z(V,"library_lights","light",Lt),z(V,"library_geometries","geometry",Ot),z(V,"library_nodes","node",qe),z(V,"library_visual_scenes","visual_scene",an),z(V,"library_kinematics_models","kinematics_model",Bt),z(V,"library_physics_models","physics_model",Jt),z(V,"scene","instance_kinematics_scene",Yt),Y(w.animations,ye),Y(w.clips,L),Y(w.controllers,A),Y(w.images,G),Y(w.effects,De),Y(w.materials,Je),Y(w.cameras,Ke),Y(w.lights,We),Y(w.geometries,Ye),Y(w.visualScenes,it),dn(),$t();const _e=ln(I(V,"scene")[0]);return _e.animations=Te,ot.upAxis==="Z_UP"&&(console.warn("THREE.ColladaLoader: You are loading an asset with a Z-UP coordinate system. The loader just rotates the asset to transform it into Y-UP. The vertex data are not converted, see #24289."),_e.rotation.set(-Math.PI/2,0,0)),_e.scale.multiplyScalar(ot.unit),{get animations(){return console.warn("THREE.ColladaLoader: Please access animations over scene.animations now."),Te},kinematics:ct,library:w,scene:_e}}}},3104:function(ve,dt,pe){var ie=Object.defineProperty,Ee=Object.getOwnPropertyDescriptor,xe=Object.getOwnPropertyNames,Ce=Object.prototype.hasOwnProperty,Le=($,j)=>{for(var B in j)ie($,B,{get:j[B],enumerable:!0})},Re=($,j,B,J)=>{if(j&&typeof j=="object"||typeof j=="function")for(let I of xe(j))!Ce.call($,I)&&I!==B&&ie($,I,{get:()=>j[I],enumerable:!(J=Ee(j,I))||J.enumerable});return $},Ie=$=>Re(ie({},"__esModule",{value:!0}),$),le={};Le(le,{TGALoader:()=>me}),ve.exports=Ie(le);var c=pe(933);class me extends c.DataTextureLoader{constructor(j){super(j)}parse(j){function B(p){switch(p.image_type){case be:case Y:if(p.colormap_length>256||p.colormap_size!==24||p.colormap_type!==1)throw new Error("THREE.TGALoader: Invalid type colormap data for indexed type.");break;case ge:case z:case D:case ue:if(p.colormap_type)throw new Error("THREE.TGALoader: Invalid type colormap data for colormap type.");break;case Me:throw new Error("THREE.TGALoader: No data.");default:throw new Error("THREE.TGALoader: Invalid type "+p.image_type)}if(p.width<=0||p.height<=0)throw new Error("THREE.TGALoader: Invalid image size.");if(p.pixel_size!==8&&p.pixel_size!==16&&p.pixel_size!==24&&p.pixel_size!==32)throw new Error("THREE.TGALoader: Invalid pixel size "+p.pixel_size)}function J(p,H,L,C,F){let E,R;const T=L.pixel_size>>3,A=L.width*L.height*T;if(H&&(R=F.subarray(C,C+=L.colormap_length*(L.colormap_size>>3))),p){E=new Uint8Array(A);let k,f,N,G=0;const X=new Uint8Array(T);for(;G<A;)if(k=F[C++],f=(k&127)+1,k&128){for(N=0;N<T;++N)X[N]=F[C++];for(N=0;N<f;++N)E.set(X,G+N*T);G+=T*f}else{for(f*=T,N=0;N<f;++N)E[G+N]=F[C++];G+=f}}else E=F.subarray(C,C+=H?L.width*L.height:A);return{pixel_data:E,palettes:R}}function I(p,H,L,C,F,E,R,T,A){const k=A;let f,N=0,G,X;const re=S.width;for(X=H;X!==C;X+=L)for(G=F;G!==R;G+=E,N++)f=T[N],p[(G+re*X)*4+3]=255,p[(G+re*X)*4+2]=k[f*3+0],p[(G+re*X)*4+1]=k[f*3+1],p[(G+re*X)*4+0]=k[f*3+2];return p}function W(p,H,L,C,F,E,R,T){let A,k=0,f,N;const G=S.width;for(N=H;N!==C;N+=L)for(f=F;f!==R;f+=E,k+=2)A=T[k+0]+(T[k+1]<<8),p[(f+G*N)*4+0]=(A&31744)>>7,p[(f+G*N)*4+1]=(A&992)>>2,p[(f+G*N)*4+2]=(A&31)<<3,p[(f+G*N)*4+3]=A&32768?0:255;return p}function M(p,H,L,C,F,E,R,T){let A=0,k,f;const N=S.width;for(f=H;f!==C;f+=L)for(k=F;k!==R;k+=E,A+=3)p[(k+N*f)*4+3]=255,p[(k+N*f)*4+2]=T[A+0],p[(k+N*f)*4+1]=T[A+1],p[(k+N*f)*4+0]=T[A+2];return p}function te(p,H,L,C,F,E,R,T){let A=0,k,f;const N=S.width;for(f=H;f!==C;f+=L)for(k=F;k!==R;k+=E,A+=4)p[(k+N*f)*4+2]=T[A+0],p[(k+N*f)*4+1]=T[A+1],p[(k+N*f)*4+0]=T[A+2],p[(k+N*f)*4+3]=T[A+3];return p}function P(p,H,L,C,F,E,R,T){let A,k=0,f,N;const G=S.width;for(N=H;N!==C;N+=L)for(f=F;f!==R;f+=E,k++)A=T[k],p[(f+G*N)*4+0]=A,p[(f+G*N)*4+1]=A,p[(f+G*N)*4+2]=A,p[(f+G*N)*4+3]=255;return p}function de(p,H,L,C,F,E,R,T){let A=0,k,f;const N=S.width;for(f=H;f!==C;f+=L)for(k=F;k!==R;k+=E,A+=2)p[(k+N*f)*4+0]=T[A+0],p[(k+N*f)*4+1]=T[A+0],p[(k+N*f)*4+2]=T[A+0],p[(k+N*f)*4+3]=T[A+1];return p}function ne(p,H,L,C,F){let E,R,T,A,k,f;switch((S.flags&Oe)>>Se){default:case Ge:E=0,T=1,k=H,R=0,A=1,f=L;break;case ye:E=0,T=1,k=H,R=L-1,A=-1,f=-1;break;case Pe:E=H-1,T=-1,k=-1,R=0,A=1,f=L;break;case ke:E=H-1,T=-1,k=-1,R=L-1,A=-1,f=-1;break}if(he)switch(S.pixel_size){case 8:P(p,R,A,f,E,T,k,C);break;case 16:de(p,R,A,f,E,T,k,C);break;default:throw new Error("THREE.TGALoader: Format not supported.")}else switch(S.pixel_size){case 8:I(p,R,A,f,E,T,k,C,F);break;case 16:W(p,R,A,f,E,T,k,C);break;case 24:M(p,R,A,f,E,T,k,C);break;case 32:te(p,R,A,f,E,T,k,C);break;default:throw new Error("THREE.TGALoader: Format not supported.")}return p}const Me=0,be=1,ge=2,z=3,Y=9,D=10,ue=11,Oe=48,Se=4,ye=0,ke=1,Ge=2,Pe=3;if(j.length<19)throw new Error("THREE.TGALoader: Not enough data to contain header.");let O=0;const q=new Uint8Array(j),S={id_length:q[O++],colormap_type:q[O++],image_type:q[O++],colormap_index:q[O++]|q[O++]<<8,colormap_length:q[O++]|q[O++]<<8,colormap_size:q[O++],origin:[q[O++]|q[O++]<<8,q[O++]|q[O++]<<8],width:q[O++]|q[O++]<<8,height:q[O++]|q[O++]<<8,pixel_size:q[O++],flags:q[O++]};if(B(S),S.id_length+O>j.length)throw new Error("THREE.TGALoader: No data.");O+=S.id_length;let se=!1,fe=!1,he=!1;switch(S.image_type){case Y:se=!0,fe=!0;break;case be:fe=!0;break;case D:se=!0;break;case ge:break;case ue:se=!0,he=!0;break;case z:he=!0;break}const we=new Uint8Array(S.width*S.height*4),Ne=J(se,fe,S,O,q);return ne(we,S.width,S.height,Ne.pixel_data,Ne.palettes),{data:we,width:S.width,height:S.height,flipY:!0,generateMipmaps:!0,minFilter:c.LinearMipmapLinearFilter}}}}}]);
