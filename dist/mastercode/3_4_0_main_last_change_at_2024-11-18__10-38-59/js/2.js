(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{3096:function(q,ne,J){var K=Object.create,z=Object.defineProperty,G=Object.getOwnPropertyDescriptor,W=Object.getOwnPropertyNames,P=Object.getPrototypeOf,ee=Object.prototype.hasOwnProperty,b=(v,n)=>{for(var t in n)z(v,t,{get:n[t],enumerable:!0})},A=(v,n,t,h)=>{if(n&&typeof n=="object"||typeof n=="function")for(let l of W(n))!ee.call(v,l)&&l!==t&&z(v,l,{get:()=>n[l],enumerable:!(h=G(n,l))||h.enumerable});return v},C=(v,n,t)=>(t=v!=null?K(P(v)):{},A(n||!v||!v.__esModule?z(t,"default",{value:v,enumerable:!0}):t,v)),N=v=>A(z({},"__esModule",{value:!0}),v),f={};b(f,{default:()=>i}),q.exports=N(f);var e=J(3101),r=C(J(3102)),o=C(J(1797)),a=J(280);class i extends o.default{constructor(n){super(),this.planarConfiguration=typeof n.PlanarConfiguration<"u"?n.PlanarConfiguration:1,this.samplesPerPixel=typeof n.SamplesPerPixel<"u"?n.SamplesPerPixel:1,this.addCompression=n.LercParameters[a.LercParameters.AddCompression]}decodeBlock(n){switch(this.addCompression){case a.LercAddCompression.None:break;case a.LercAddCompression.Deflate:n=(0,e.inflate)(new Uint8Array(n)).buffer;break;default:throw new Error(`Unsupported LERC additional compression method identifier: ${this.addCompression}`)}return r.default.decode(n,{returnPixelInterleavedDims:this.planarConfiguration===1}).pixels[0].buffer}}},3102:function(q,ne,J){var K,z;/* Copyright 2015-2021 Esri. Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0 @preserve */(function(){var G=function(){var b={};b.defaultNoDataValue=-34027999387901484e22,b.decode=function(r,o){o=o||{};var a=o.encodedMaskData||o.encodedMaskData===null,i=f(r,o.inputOffset||0,a),v=o.noDataValue!==null?o.noDataValue:b.defaultNoDataValue,n=A(i,o.pixelType||Float32Array,o.encodedMaskData,v,o.returnMask),t={width:i.width,height:i.height,pixelData:n.resultPixels,minValue:n.minValue,maxValue:i.pixels.maxValue,noDataValue:v};return n.resultMask&&(t.maskData=n.resultMask),o.returnEncodedMask&&i.mask&&(t.encodedMaskData=i.mask.bitset?i.mask.bitset:null),o.returnFileInfo&&(t.fileInfo=C(i),o.computeUsedBitDepths&&(t.fileInfo.bitDepths=N(i))),t};var A=function(r,o,a,i,v){var n=0,t=r.pixels.numBlocksX,h=r.pixels.numBlocksY,l=Math.floor(r.width/t),m=Math.floor(r.height/h),g=2*r.maxZError,u=Number.MAX_VALUE,s;a=a||(r.mask?r.mask.bitset:null);var w,I;w=new o(r.width*r.height),v&&a&&(I=new Uint8Array(r.width*r.height));for(var V=new Float32Array(l*m),d,y,k=0;k<=h;k++){var S=k!==h?m:r.height%h;if(S!==0)for(var p=0;p<=t;p++){var c=p!==t?l:r.width%t;if(c!==0){var U=k*r.width*m+p*l,T=r.width-c,x=r.pixels.blocks[n],D,M,L;x.encoding<2?(x.encoding===0?D=x.rawData:(e(x.stuffedData,x.bitsPerPixel,x.numValidPixels,x.offset,g,V,r.pixels.maxValue),D=V),M=0):x.encoding===2?L=0:L=x.offset;var B;if(a)for(y=0;y<S;y++){for(U&7&&(B=a[U>>3],B<<=U&7),d=0;d<c;d++)U&7||(B=a[U>>3]),B&128?(I&&(I[U]=1),s=x.encoding<2?D[M++]:L,u=u>s?s:u,w[U++]=s):(I&&(I[U]=0),w[U++]=i),B<<=1;U+=T}else if(x.encoding<2)for(y=0;y<S;y++){for(d=0;d<c;d++)s=D[M++],u=u>s?s:u,w[U++]=s;U+=T}else for(u=u>L?L:u,y=0;y<S;y++){for(d=0;d<c;d++)w[U++]=L;U+=T}if(x.encoding===1&&M!==x.numValidPixels)throw"Block and Mask do not match";n++}}}return{resultPixels:w,resultMask:I,minValue:u}},C=function(r){return{fileIdentifierString:r.fileIdentifierString,fileVersion:r.fileVersion,imageType:r.imageType,height:r.height,width:r.width,maxZError:r.maxZError,eofOffset:r.eofOffset,mask:r.mask?{numBlocksX:r.mask.numBlocksX,numBlocksY:r.mask.numBlocksY,numBytes:r.mask.numBytes,maxValue:r.mask.maxValue}:null,pixels:{numBlocksX:r.pixels.numBlocksX,numBlocksY:r.pixels.numBlocksY,numBytes:r.pixels.numBytes,maxValue:r.pixels.maxValue,noDataValue:r.noDataValue}}},N=function(r){for(var o=r.pixels.numBlocksX*r.pixels.numBlocksY,a={},i=0;i<o;i++){var v=r.pixels.blocks[i];v.encoding===0?a.float32=!0:v.encoding===1?a[v.bitsPerPixel]=!0:a[0]=!0}return Object.keys(a)},f=function(r,o,a){var i={},v=new Uint8Array(r,o,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,v),i.fileIdentifierString.trim()!=="CntZImage")throw"Unexpected file identifier string: "+i.fileIdentifierString;o+=10;var n=new DataView(r,o,24);if(i.fileVersion=n.getInt32(0,!0),i.imageType=n.getInt32(4,!0),i.height=n.getUint32(8,!0),i.width=n.getUint32(12,!0),i.maxZError=n.getFloat64(16,!0),o+=24,!a)if(n=new DataView(r,o,16),i.mask={},i.mask.numBlocksY=n.getUint32(0,!0),i.mask.numBlocksX=n.getUint32(4,!0),i.mask.numBytes=n.getUint32(8,!0),i.mask.maxValue=n.getFloat32(12,!0),o+=16,i.mask.numBytes>0){var t=new Uint8Array(Math.ceil(i.width*i.height/8));n=new DataView(r,o,i.mask.numBytes);var h=n.getInt16(0,!0),l=2,m=0;do{if(h>0)for(;h--;)t[m++]=n.getUint8(l++);else{var g=n.getUint8(l++);for(h=-h;h--;)t[m++]=g}h=n.getInt16(l,!0),l+=2}while(l<i.mask.numBytes);if(h!==-32768||m<t.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=t,o+=i.mask.numBytes}else i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue||(i.mask.bitset=new Uint8Array(Math.ceil(i.width*i.height/8)));n=new DataView(r,o,16),i.pixels={},i.pixels.numBlocksY=n.getUint32(0,!0),i.pixels.numBlocksX=n.getUint32(4,!0),i.pixels.numBytes=n.getUint32(8,!0),i.pixels.maxValue=n.getFloat32(12,!0),o+=16;var u=i.pixels.numBlocksX,s=i.pixels.numBlocksY,w=u+(i.width%u>0?1:0),I=s+(i.height%s>0?1:0);i.pixels.blocks=new Array(w*I);for(var V=0,d=0;d<I;d++)for(var y=0;y<w;y++){var k=0,S=r.byteLength-o;n=new DataView(r,o,Math.min(10,S));var p={};i.pixels.blocks[V++]=p;var c=n.getUint8(0);if(k++,p.encoding=c&63,p.encoding>3)throw"Invalid block encoding ("+p.encoding+")";if(p.encoding===2){o++;continue}if(c!==0&&c!==2){if(c>>=6,p.offsetType=c,c===2)p.offset=n.getInt8(1),k++;else if(c===1)p.offset=n.getInt16(1,!0),k+=2;else if(c===0)p.offset=n.getFloat32(1,!0),k+=4;else throw"Invalid block offset type";if(p.encoding===1)if(c=n.getUint8(k),k++,p.bitsPerPixel=c&63,c>>=6,p.numValidPixelsType=c,c===2)p.numValidPixels=n.getUint8(k),k++;else if(c===1)p.numValidPixels=n.getUint16(k,!0),k+=2;else if(c===0)p.numValidPixels=n.getUint32(k,!0),k+=4;else throw"Invalid valid pixel count type"}if(o+=k,p.encoding!==3){var U,T;if(p.encoding===0){var x=(i.pixels.numBytes-1)/4;if(x!==Math.floor(x))throw"uncompressed block has invalid length";U=new ArrayBuffer(x*4),T=new Uint8Array(U),T.set(new Uint8Array(r,o,x*4));var D=new Float32Array(U);p.rawData=D,o+=x*4}else if(p.encoding===1){var M=Math.ceil(p.numValidPixels*p.bitsPerPixel/8),L=Math.ceil(M/4);U=new ArrayBuffer(L*4),T=new Uint8Array(U),T.set(new Uint8Array(r,o,M)),p.stuffedData=new Uint32Array(U),o+=M}}}return i.eofOffset=o,i},e=function(r,o,a,i,v,n,t){var h=(1<<o)-1,l=0,m,g=0,u,s,w=Math.ceil((t-i)/v),I=r.length*4-Math.ceil(o*a/8);for(r[r.length-1]<<=8*I,m=0;m<a;m++){if(g===0&&(s=r[l++],g=32),g>=o)u=s>>>g-o&h,g-=o;else{var V=o-g;u=(s&h)<<V&h,s=r[l++],g=32-V,u+=s>>>g}n[m]=u<w?i+u*v:t}return n};return b}(),W=function(){"use strict";var b={unstuff:function(f,e,r,o,a,i,v,n){var t=(1<<r)-1,h=0,l,m=0,g,u,s,w,I=f.length*4-Math.ceil(r*o/8);if(f[f.length-1]<<=8*I,a)for(l=0;l<o;l++)m===0&&(u=f[h++],m=32),m>=r?(g=u>>>m-r&t,m-=r):(s=r-m,g=(u&t)<<s&t,u=f[h++],m=32-s,g+=u>>>m),e[l]=a[g];else for(w=Math.ceil((n-i)/v),l=0;l<o;l++)m===0&&(u=f[h++],m=32),m>=r?(g=u>>>m-r&t,m-=r):(s=r-m,g=(u&t)<<s&t,u=f[h++],m=32-s,g+=u>>>m),e[l]=g<w?i+g*v:n},unstuffLUT:function(f,e,r,o,a,i){var v=(1<<e)-1,n=0,t=0,h=0,l=0,m=0,g,u=[],s=f.length*4-Math.ceil(e*r/8);f[f.length-1]<<=8*s;var w=Math.ceil((i-o)/a);for(t=0;t<r;t++)l===0&&(g=f[n++],l=32),l>=e?(m=g>>>l-e&v,l-=e):(h=e-l,m=(g&v)<<h&v,g=f[n++],l=32-h,m+=g>>>l),u[t]=m<w?o+m*a:i;return u.unshift(o),u},unstuff2:function(f,e,r,o,a,i,v,n){var t=(1<<r)-1,h=0,l,m=0,g=0,u,s,w;if(a)for(l=0;l<o;l++)m===0&&(s=f[h++],m=32,g=0),m>=r?(u=s>>>g&t,m-=r,g+=r):(w=r-m,u=s>>>g&t,s=f[h++],m=32-w,u|=(s&(1<<w)-1)<<r-w,g=w),e[l]=a[u];else{var I=Math.ceil((n-i)/v);for(l=0;l<o;l++)m===0&&(s=f[h++],m=32,g=0),m>=r?(u=s>>>g&t,m-=r,g+=r):(w=r-m,u=s>>>g&t,s=f[h++],m=32-w,u|=(s&(1<<w)-1)<<r-w,g=w),e[l]=u<I?i+u*v:n}return e},unstuffLUT2:function(f,e,r,o,a,i){var v=(1<<e)-1,n=0,t=0,h=0,l=0,m=0,g=0,u,s=[],w=Math.ceil((i-o)/a);for(t=0;t<r;t++)l===0&&(u=f[n++],l=32,g=0),l>=e?(m=u>>>g&v,l-=e,g+=e):(h=e-l,m=u>>>g&v,u=f[n++],l=32-h,m|=(u&(1<<h)-1)<<e-h,g=h),s[t]=m<w?o+m*a:i;return s.unshift(o),s},originalUnstuff:function(f,e,r,o){var a=(1<<r)-1,i=0,v,n=0,t,h,l,m=f.length*4-Math.ceil(r*o/8);for(f[f.length-1]<<=8*m,v=0;v<o;v++)n===0&&(h=f[i++],n=32),n>=r?(t=h>>>n-r&a,n-=r):(l=r-n,t=(h&a)<<l&a,h=f[i++],n=32-l,t+=h>>>n),e[v]=t;return e},originalUnstuff2:function(f,e,r,o){var a=(1<<r)-1,i=0,v,n=0,t=0,h,l,m;for(v=0;v<o;v++)n===0&&(l=f[i++],n=32,t=0),n>=r?(h=l>>>t&a,n-=r,t+=r):(m=r-n,h=l>>>t&a,l=f[i++],n=32-m,h|=(l&(1<<m)-1)<<r-m,t=m),e[v]=h;return e}},A={HUFFMAN_LUT_BITS_MAX:12,computeChecksumFletcher32:function(f){for(var e=65535,r=65535,o=f.length,a=Math.floor(o/2),i=0;a;){var v=a>=359?359:a;a-=v;do e+=f[i++]<<8,r+=e+=f[i++];while(--v);e=(e&65535)+(e>>>16),r=(r&65535)+(r>>>16)}return o&1&&(r+=e+=f[i]<<8),e=(e&65535)+(e>>>16),r=(r&65535)+(r>>>16),(r<<16|e)>>>0},readHeaderInfo:function(f,e){var r=e.ptr,o=new Uint8Array(f,r,6),a={};if(a.fileIdentifierString=String.fromCharCode.apply(null,o),a.fileIdentifierString.lastIndexOf("Lerc2",0)!==0)throw"Unexpected file identifier string (expect Lerc2 ): "+a.fileIdentifierString;r+=6;var i=new DataView(f,r,8),v=i.getInt32(0,!0);a.fileVersion=v,r+=4,v>=3&&(a.checksum=i.getUint32(4,!0),r+=4),i=new DataView(f,r,12),a.height=i.getUint32(0,!0),a.width=i.getUint32(4,!0),r+=8,v>=4?(a.numDims=i.getUint32(8,!0),r+=4):a.numDims=1,i=new DataView(f,r,40),a.numValidPixel=i.getUint32(0,!0),a.microBlockSize=i.getInt32(4,!0),a.blobSize=i.getInt32(8,!0),a.imageType=i.getInt32(12,!0),a.maxZError=i.getFloat64(16,!0),a.zMin=i.getFloat64(24,!0),a.zMax=i.getFloat64(32,!0),r+=40,e.headerInfo=a,e.ptr=r;var n,t;if(v>=3&&(t=v>=4?52:48,n=this.computeChecksumFletcher32(new Uint8Array(f,r-t,a.blobSize-14)),n!==a.checksum))throw"Checksum failed.";return!0},checkMinMaxRanges:function(f,e){var r=e.headerInfo,o=this.getDataTypeArray(r.imageType),a=r.numDims*this.getDataTypeSize(r.imageType),i=this.readSubArray(f,e.ptr,o,a),v=this.readSubArray(f,e.ptr+a,o,a);e.ptr+=2*a;var n,t=!0;for(n=0;n<r.numDims;n++)if(i[n]!==v[n]){t=!1;break}return r.minValues=i,r.maxValues=v,t},readSubArray:function(f,e,r,o){var a;if(r===Uint8Array)a=new Uint8Array(f,e,o);else{var i=new ArrayBuffer(o),v=new Uint8Array(i);v.set(new Uint8Array(f,e,o)),a=new r(i)}return a},readMask:function(f,e){var r=e.ptr,o=e.headerInfo,a=o.width*o.height,i=o.numValidPixel,v=new DataView(f,r,4),n={};if(n.numBytes=v.getUint32(0,!0),r+=4,(i===0||a===i)&&n.numBytes!==0)throw"invalid mask";var t,h;if(i===0)t=new Uint8Array(Math.ceil(a/8)),n.bitset=t,h=new Uint8Array(a),e.pixels.resultMask=h,r+=n.numBytes;else if(n.numBytes>0){t=new Uint8Array(Math.ceil(a/8)),v=new DataView(f,r,n.numBytes);var l=v.getInt16(0,!0),m=2,g=0,u=0;do{if(l>0)for(;l--;)t[g++]=v.getUint8(m++);else for(u=v.getUint8(m++),l=-l;l--;)t[g++]=u;l=v.getInt16(m,!0),m+=2}while(m<n.numBytes);if(l!==-32768||g<t.length)throw"Unexpected end of mask RLE encoding";h=new Uint8Array(a);var s=0,w=0;for(w=0;w<a;w++)w&7?(s=t[w>>3],s<<=w&7):s=t[w>>3],s&128&&(h[w]=1);e.pixels.resultMask=h,n.bitset=t,r+=n.numBytes}return e.ptr=r,e.mask=n,!0},readDataOneSweep:function(f,e,r,o){var a=e.ptr,i=e.headerInfo,v=i.numDims,n=i.width*i.height,t=i.imageType,h=i.numValidPixel*A.getDataTypeSize(t)*v,l,m=e.pixels.resultMask;if(r===Uint8Array)l=new Uint8Array(f,a,h);else{var g=new ArrayBuffer(h),u=new Uint8Array(g);u.set(new Uint8Array(f,a,h)),l=new r(g)}if(l.length===n*v)o?e.pixels.resultPixels=A.swapDimensionOrder(l,n,v,r,!0):e.pixels.resultPixels=l;else{e.pixels.resultPixels=new r(n*v);var s=0,w=0,I=0,V=0;if(v>1){if(o){for(w=0;w<n;w++)if(m[w])for(V=w,I=0;I<v;I++,V+=n)e.pixels.resultPixels[V]=l[s++]}else for(w=0;w<n;w++)if(m[w])for(V=w*v,I=0;I<v;I++)e.pixels.resultPixels[V+I]=l[s++]}else for(w=0;w<n;w++)m[w]&&(e.pixels.resultPixels[w]=l[s++])}return a+=h,e.ptr=a,!0},readHuffmanTree:function(f,e){var r=this.HUFFMAN_LUT_BITS_MAX,o=new DataView(f,e.ptr,16);e.ptr+=16;var a=o.getInt32(0,!0);if(a<2)throw"unsupported Huffman version";var i=o.getInt32(4,!0),v=o.getInt32(8,!0),n=o.getInt32(12,!0);if(v>=n)return!1;var t=new Uint32Array(n-v);A.decodeBits(f,e,t);var h=[],l,m,g,u;for(l=v;l<n;l++)m=l-(l<i?0:i),h[m]={first:t[l-v],second:null};var s=f.byteLength-e.ptr,w=Math.ceil(s/4),I=new ArrayBuffer(w*4),V=new Uint8Array(I);V.set(new Uint8Array(f,e.ptr,s));var d=new Uint32Array(I),y=0,k,S=0;for(k=d[0],l=v;l<n;l++)m=l-(l<i?0:i),u=h[m].first,u>0&&(h[m].second=k<<y>>>32-u,32-y>=u?(y+=u,y===32&&(y=0,S++,k=d[S])):(y+=u-32,S++,k=d[S],h[m].second|=k>>>32-y));var p=0,c=0,U=new C;for(l=0;l<h.length;l++)h[l]!==void 0&&(p=Math.max(p,h[l].first));p>=r?c=r:c=p;var T=[],x,D,M,L,B,_;for(l=v;l<n;l++)if(m=l-(l<i?0:i),u=h[m].first,u>0)if(x=[u,m],u<=c)for(D=h[m].second<<c-u,M=1<<c-u,g=0;g<M;g++)T[D|g]=x;else for(D=h[m].second,_=U,L=u-1;L>=0;L--)B=D>>>L&1,B?(_.right||(_.right=new C),_=_.right):(_.left||(_.left=new C),_=_.left),L===0&&!_.val&&(_.val=x[1]);return{decodeLut:T,numBitsLUTQick:c,numBitsLUT:p,tree:U,stuffedData:d,srcPtr:S,bitPos:y}},readHuffman:function(f,e,r,o){var a=e.headerInfo,i=a.numDims,v=e.headerInfo.height,n=e.headerInfo.width,t=n*v,h=this.readHuffmanTree(f,e),l=h.decodeLut,m=h.tree,g=h.stuffedData,u=h.srcPtr,s=h.bitPos,w=h.numBitsLUTQick,I=h.numBitsLUT,V=e.headerInfo.imageType===0?128:0,d,y,k,S=e.pixels.resultMask,p,c,U,T,x,D,M,L=0;s>0&&(u++,s=0);var B=g[u],_=e.encodeMode===1,Z=new r(t*i),F=Z,O;if(i<2||_){for(O=0;O<i;O++)if(i>1&&(F=new r(Z.buffer,t*O,t),L=0),e.headerInfo.numValidPixel===n*v)for(D=0,T=0;T<v;T++)for(x=0;x<n;x++,D++){if(y=0,p=B<<s>>>32-w,c=p,32-s<w&&(p|=g[u+1]>>>64-s-w,c=p),l[c])y=l[c][1],s+=l[c][0];else for(p=B<<s>>>32-I,c=p,32-s<I&&(p|=g[u+1]>>>64-s-I,c=p),d=m,M=0;M<I;M++)if(U=p>>>I-M-1&1,d=U?d.right:d.left,!(d.left||d.right)){y=d.val,s=s+M+1;break}s>=32&&(s-=32,u++,B=g[u]),k=y-V,_?(x>0?k+=L:T>0?k+=F[D-n]:k+=L,k&=255,F[D]=k,L=k):F[D]=k}else for(D=0,T=0;T<v;T++)for(x=0;x<n;x++,D++)if(S[D]){if(y=0,p=B<<s>>>32-w,c=p,32-s<w&&(p|=g[u+1]>>>64-s-w,c=p),l[c])y=l[c][1],s+=l[c][0];else for(p=B<<s>>>32-I,c=p,32-s<I&&(p|=g[u+1]>>>64-s-I,c=p),d=m,M=0;M<I;M++)if(U=p>>>I-M-1&1,d=U?d.right:d.left,!(d.left||d.right)){y=d.val,s=s+M+1;break}s>=32&&(s-=32,u++,B=g[u]),k=y-V,_?(x>0&&S[D-1]?k+=L:T>0&&S[D-n]?k+=F[D-n]:k+=L,k&=255,F[D]=k,L=k):F[D]=k}}else for(D=0,T=0;T<v;T++)for(x=0;x<n;x++)if(D=T*n+x,!S||S[D])for(O=0;O<i;O++,D+=t){if(y=0,p=B<<s>>>32-w,c=p,32-s<w&&(p|=g[u+1]>>>64-s-w,c=p),l[c])y=l[c][1],s+=l[c][0];else for(p=B<<s>>>32-I,c=p,32-s<I&&(p|=g[u+1]>>>64-s-I,c=p),d=m,M=0;M<I;M++)if(U=p>>>I-M-1&1,d=U?d.right:d.left,!(d.left||d.right)){y=d.val,s=s+M+1;break}s>=32&&(s-=32,u++,B=g[u]),k=y-V,F[D]=k}e.ptr=e.ptr+(u+1)*4+(s>0?4:0),e.pixels.resultPixels=Z,i>1&&!o&&(e.pixels.resultPixels=A.swapDimensionOrder(Z,t,i,r))},decodeBits:function(f,e,r,o,a){{var i=e.headerInfo,v=i.fileVersion,n=0,t=f.byteLength-e.ptr>=5?5:f.byteLength-e.ptr,h=new DataView(f,e.ptr,t),l=h.getUint8(0);n++;var m=l>>6,g=m===0?4:3-m,u=(l&32)>0,s=l&31,w=0;if(g===1)w=h.getUint8(n),n++;else if(g===2)w=h.getUint16(n,!0),n+=2;else if(g===4)w=h.getUint32(n,!0),n+=4;else throw"Invalid valid pixel count type";var I=2*i.maxZError,V,d,y,k,S,p,c,U,T,x,D=i.numDims>1?i.maxValues[a]:i.zMax;if(u){for(e.counter.lut++,U=h.getUint8(n),T=s,n++,k=Math.ceil((U-1)*s/8),S=Math.ceil(k/4),d=new ArrayBuffer(S*4),y=new Uint8Array(d),e.ptr+=n,y.set(new Uint8Array(f,e.ptr,k)),c=new Uint32Array(d),e.ptr+=k,x=0;U-1>>>x;)x++;k=Math.ceil(w*x/8),S=Math.ceil(k/4),d=new ArrayBuffer(S*4),y=new Uint8Array(d),y.set(new Uint8Array(f,e.ptr,k)),V=new Uint32Array(d),e.ptr+=k,v>=3?p=b.unstuffLUT2(c,s,U-1,o,I,D):p=b.unstuffLUT(c,s,U-1,o,I,D),v>=3?b.unstuff2(V,r,x,w,p):b.unstuff(V,r,x,w,p)}else e.counter.bitstuffer++,x=s,e.ptr+=n,x>0&&(k=Math.ceil(w*x/8),S=Math.ceil(k/4),d=new ArrayBuffer(S*4),y=new Uint8Array(d),y.set(new Uint8Array(f,e.ptr,k)),V=new Uint32Array(d),e.ptr+=k,v>=3?o==null?b.originalUnstuff2(V,r,x,w):b.unstuff2(V,r,x,w,!1,o,I,D):o==null?b.originalUnstuff(V,r,x,w):b.unstuff(V,r,x,w,!1,o,I,D))}},readTiles:function(f,e,r,o){var a=e.headerInfo,i=a.width,v=a.height,n=i*v,t=a.microBlockSize,h=a.imageType,l=A.getDataTypeSize(h),m=Math.ceil(i/t),g=Math.ceil(v/t);e.pixels.numBlocksY=g,e.pixels.numBlocksX=m,e.pixels.ptr=0;var u=0,s=0,w=0,I=0,V=0,d=0,y=0,k=0,S=0,p=0,c=0,U=0,T=0,x=0,D=0,M=0,L,B,_,Z,F,O,Q=new r(t*t),te=v%t||t,fe=i%t||t,re,H,$=a.numDims,R,E=e.pixels.resultMask,X=e.pixels.resultPixels,se=a.fileVersion,ae=se>=5?14:15,Y,ie=a.zMax,j;for(w=0;w<g;w++)for(V=w!==g-1?t:te,I=0;I<m;I++)for(d=I!==m-1?t:fe,c=w*i*t+I*t,U=i-d,R=0;R<$;R++){if($>1?(j=X,c=w*i*t+I*t,X=new r(e.pixels.resultPixels.buffer,n*R*l,n),ie=a.maxValues[R]):j=null,y=f.byteLength-e.ptr,L=new DataView(f,e.ptr,Math.min(10,y)),B={},M=0,k=L.getUint8(0),M++,Y=a.fileVersion>=5?k&4:0,S=k>>6&255,p=k>>2&ae,p!==(I*t>>3&ae)||Y&&R===0)throw"integrity issue";if(O=k&3,O>3)throw e.ptr+=M,"Invalid block encoding ("+O+")";if(O===2){if(Y)if(E)for(u=0;u<V;u++)for(s=0;s<d;s++)E[c]&&(X[c]=j[c]),c++;else for(u=0;u<V;u++)for(s=0;s<d;s++)X[c]=j[c],c++;e.counter.constant++,e.ptr+=M;continue}else if(O===0){if(Y)throw"integrity issue";if(e.counter.uncompressed++,e.ptr+=M,T=V*d*l,x=f.byteLength-e.ptr,T=T<x?T:x,_=new ArrayBuffer(T%l===0?T:T+l-T%l),Z=new Uint8Array(_),Z.set(new Uint8Array(f,e.ptr,T)),F=new r(_),D=0,E)for(u=0;u<V;u++){for(s=0;s<d;s++)E[c]&&(X[c]=F[D++]),c++;c+=U}else for(u=0;u<V;u++){for(s=0;s<d;s++)X[c++]=F[D++];c+=U}e.ptr+=D*l}else if(re=A.getDataTypeUsed(Y&&h<6?4:h,S),H=A.getOnePixel(B,M,re,L),M+=A.getDataTypeSize(re),O===3)if(e.ptr+=M,e.counter.constantoffset++,E)for(u=0;u<V;u++){for(s=0;s<d;s++)E[c]&&(X[c]=Y?Math.min(ie,j[c]+H):H),c++;c+=U}else for(u=0;u<V;u++){for(s=0;s<d;s++)X[c]=Y?Math.min(ie,j[c]+H):H,c++;c+=U}else if(e.ptr+=M,A.decodeBits(f,e,Q,H,R),M=0,Y)if(E)for(u=0;u<V;u++){for(s=0;s<d;s++)E[c]&&(X[c]=Q[M++]+j[c]),c++;c+=U}else for(u=0;u<V;u++){for(s=0;s<d;s++)X[c]=Q[M++]+j[c],c++;c+=U}else if(E)for(u=0;u<V;u++){for(s=0;s<d;s++)E[c]&&(X[c]=Q[M++]),c++;c+=U}else for(u=0;u<V;u++){for(s=0;s<d;s++)X[c++]=Q[M++];c+=U}}$>1&&!o&&(e.pixels.resultPixels=A.swapDimensionOrder(e.pixels.resultPixels,n,$,r))},formatFileInfo:function(f){return{fileIdentifierString:f.headerInfo.fileIdentifierString,fileVersion:f.headerInfo.fileVersion,imageType:f.headerInfo.imageType,height:f.headerInfo.height,width:f.headerInfo.width,numValidPixel:f.headerInfo.numValidPixel,microBlockSize:f.headerInfo.microBlockSize,blobSize:f.headerInfo.blobSize,maxZError:f.headerInfo.maxZError,pixelType:A.getPixelType(f.headerInfo.imageType),eofOffset:f.eofOffset,mask:f.mask?{numBytes:f.mask.numBytes}:null,pixels:{numBlocksX:f.pixels.numBlocksX,numBlocksY:f.pixels.numBlocksY,maxValue:f.headerInfo.zMax,minValue:f.headerInfo.zMin,noDataValue:f.noDataValue}}},constructConstantSurface:function(f,e){var r=f.headerInfo.zMax,o=f.headerInfo.zMin,a=f.headerInfo.maxValues,i=f.headerInfo.numDims,v=f.headerInfo.height*f.headerInfo.width,n=0,t=0,h=0,l=f.pixels.resultMask,m=f.pixels.resultPixels;if(l)if(i>1){if(e)for(n=0;n<i;n++)for(h=n*v,r=a[n],t=0;t<v;t++)l[t]&&(m[h+t]=r);else for(t=0;t<v;t++)if(l[t])for(h=t*i,n=0;n<i;n++)m[h+i]=a[n]}else for(t=0;t<v;t++)l[t]&&(m[t]=r);else if(i>1&&o!==r)if(e)for(n=0;n<i;n++)for(h=n*v,r=a[n],t=0;t<v;t++)m[h+t]=r;else for(t=0;t<v;t++)for(h=t*i,n=0;n<i;n++)m[h+n]=a[n];else for(t=0;t<v*i;t++)m[t]=r},getDataTypeArray:function(f){var e;switch(f){case 0:e=Int8Array;break;case 1:e=Uint8Array;break;case 2:e=Int16Array;break;case 3:e=Uint16Array;break;case 4:e=Int32Array;break;case 5:e=Uint32Array;break;case 6:e=Float32Array;break;case 7:e=Float64Array;break;default:e=Float32Array}return e},getPixelType:function(f){var e;switch(f){case 0:e="S8";break;case 1:e="U8";break;case 2:e="S16";break;case 3:e="U16";break;case 4:e="S32";break;case 5:e="U32";break;case 6:e="F32";break;case 7:e="F64";break;default:e="F32"}return e},isValidPixelValue:function(f,e){if(e==null)return!1;var r;switch(f){case 0:r=e>=-128&&e<=127;break;case 1:r=e>=0&&e<=255;break;case 2:r=e>=-32768&&e<=32767;break;case 3:r=e>=0&&e<=65536;break;case 4:r=e>=-2147483648&&e<=2147483647;break;case 5:r=e>=0&&e<=4294967296;break;case 6:r=e>=-34027999387901484e22&&e<=34027999387901484e22;break;case 7:r=e>=-17976931348623157e292&&e<=17976931348623157e292;break;default:r=!1}return r},getDataTypeSize:function(f){var e=0;switch(f){case 0:case 1:e=1;break;case 2:case 3:e=2;break;case 4:case 5:case 6:e=4;break;case 7:e=8;break;default:e=f}return e},getDataTypeUsed:function(f,e){var r=f;switch(f){case 2:case 4:r=f-e;break;case 3:case 5:r=f-2*e;break;case 6:e===0?r=f:e===1?r=2:r=1;break;case 7:e===0?r=f:r=f-2*e+1;break;default:r=f;break}return r},getOnePixel:function(f,e,r,o){var a=0;switch(r){case 0:a=o.getInt8(e);break;case 1:a=o.getUint8(e);break;case 2:a=o.getInt16(e,!0);break;case 3:a=o.getUint16(e,!0);break;case 4:a=o.getInt32(e,!0);break;case 5:a=o.getUInt32(e,!0);break;case 6:a=o.getFloat32(e,!0);break;case 7:a=o.getFloat64(e,!0);break;default:throw"the decoder does not understand this pixel type"}return a},swapDimensionOrder:function(f,e,r,o,a){var i=0,v=0,n=0,t=0,h=f;if(r>1)if(h=new o(e*r),a)for(i=0;i<e;i++)for(t=i,n=0;n<r;n++,t+=e)h[t]=f[v++];else for(i=0;i<e;i++)for(t=i,n=0;n<r;n++,t+=e)h[v++]=f[t];return h}},C=function(f,e,r){this.val=f,this.left=e,this.right=r},N={decode:function(f,e){e=e||{};var r=e.noDataValue,o=0,a={};if(a.ptr=e.inputOffset||0,a.pixels={},!!A.readHeaderInfo(f,a)){var i=a.headerInfo,v=i.fileVersion,n=A.getDataTypeArray(i.imageType);if(v>5)throw"unsupported lerc version 2."+v;A.readMask(f,a),i.numValidPixel!==i.width*i.height&&!a.pixels.resultMask&&(a.pixels.resultMask=e.maskData);var t=i.width*i.height;a.pixels.resultPixels=new n(t*i.numDims),a.counter={onesweep:0,uncompressed:0,lut:0,bitstuffer:0,constant:0,constantoffset:0};var h=!e.returnPixelInterleavedDims;if(i.numValidPixel!==0)if(i.zMax===i.zMin)A.constructConstantSurface(a,h);else if(v>=4&&A.checkMinMaxRanges(f,a))A.constructConstantSurface(a,h);else{var l=new DataView(f,a.ptr,2),m=l.getUint8(0);if(a.ptr++,m)A.readDataOneSweep(f,a,n,h);else if(v>1&&i.imageType<=1&&Math.abs(i.maxZError-.5)<1e-5){var g=l.getUint8(1);if(a.ptr++,a.encodeMode=g,g>2||v<4&&g>1)throw"Invalid Huffman flag "+g;g?A.readHuffman(f,a,n,h):A.readTiles(f,a,n,h)}else A.readTiles(f,a,n,h)}a.eofOffset=a.ptr;var u;e.inputOffset?(u=a.headerInfo.blobSize+e.inputOffset-a.ptr,Math.abs(u)>=1&&(a.eofOffset=e.inputOffset+a.headerInfo.blobSize)):(u=a.headerInfo.blobSize-a.ptr,Math.abs(u)>=1&&(a.eofOffset=a.headerInfo.blobSize));var s={width:i.width,height:i.height,pixelData:a.pixels.resultPixels,minValue:i.zMin,maxValue:i.zMax,validPixelCount:i.numValidPixel,dimCount:i.numDims,dimStats:{minValues:i.minValues,maxValues:i.maxValues},maskData:a.pixels.resultMask};if(a.pixels.resultMask&&A.isValidPixelValue(i.imageType,r)){var w=a.pixels.resultMask;for(o=0;o<t;o++)w[o]||(s.pixelData[o]=r);s.noDataValue=r}return a.noDataValue=r,e.returnFileInfo&&(s.fileInfo=A.formatFileInfo(a)),s}},getBandCount:function(f){var e=0,r=0,o={};for(o.ptr=0,o.pixels={};r<f.byteLength-58;)A.readHeaderInfo(f,o),r+=o.headerInfo.blobSize,e++,o.ptr=r;return e}};return N}(),P=function(){var b=new ArrayBuffer(4),A=new Uint8Array(b),C=new Uint32Array(b);return C[0]=1,A[0]===1}(),ee={decode:function(b,A){if(!P)throw"Big endian system is not supported.";A=A||{};var C=A.inputOffset||0,N=new Uint8Array(b,C,10),f=String.fromCharCode.apply(null,N),e,r;if(f.trim()==="CntZImage")e=G,r=1;else if(f.substring(0,5)==="Lerc2")e=W,r=2;else throw"Unexpected file identifier string: "+f;for(var o=0,a=b.byteLength-10,i,v=[],n,t,h={width:0,height:0,pixels:[],pixelType:A.pixelType,mask:null,statistics:[]},l=0;C<a;){var m=e.decode(b,{inputOffset:C,encodedMaskData:i,maskData:t,returnMask:o===0,returnEncodedMask:o===0,returnFileInfo:!0,returnPixelInterleavedDims:A.returnPixelInterleavedDims,pixelType:A.pixelType||null,noDataValue:A.noDataValue||null});C=m.fileInfo.eofOffset,t=m.maskData,o===0&&(i=m.encodedMaskData,h.width=m.width,h.height=m.height,h.dimCount=m.dimCount||1,h.pixelType=m.pixelType||m.fileInfo.pixelType,h.mask=t),r>1&&(t&&v.push(t),m.fileInfo.mask&&m.fileInfo.mask.numBytes>0&&l++),o++,h.pixels.push(m.pixelData),h.statistics.push({minValue:m.minValue,maxValue:m.maxValue,noDataValue:m.noDataValue,dimStats:m.dimStats})}var g,u,s;if(r>1&&l>1){for(s=h.width*h.height,h.bandMasks=v,t=new Uint8Array(s),t.set(v[0]),g=1;g<v.length;g++)for(n=v[g],u=0;u<s;u++)t[u]=t[u]&n[u];h.maskData=t}return h}};K=[],z=function(){return ee}.apply(ne,K),z!==void 0&&(q.exports=z)})()}}]);
